# Выбор локации для скважины

## Цель проекта

Целью проекта является построение модели машинного обучения для предсказания объёма запасов сырья в скважинах. На основе этих предсказаний необходимо выбрать регион с наибольшей потенциальной прибылью и оценить риски убытков с помощью техники **Bootstrap**.

Ключевое бизнес-ограничение: при выборе региона для разработки риск убытков не должен превышать **2.5%**.

## Особенности данных

Проект использует геологоразведочные данные для трёх различных регионов.

*   **Три набора данных:** `geo_data_0.csv`, `geo_data_1.csv`, `geo_data_2.csv`.
*   **Объем:** 100,000 скважин в каждом регионе.
*   **Признаки:**
    *   `id` — уникальный идентификатор скважины.
    *   `f0`, `f1`, `f2` — значимые геологоразведочные признаки.
    *   `product` — объём запасов в скважине (тыс. баррелей), целевой признак.
*   **Особенность:** Данные для каждого региона имеют свои уникальные статистические распределения. Пропуски и дубликаты отсутствуют.

## Технологический стек

*   **Python**
*   **Pandas**: Для загрузки, обработки и анализа данных.
*   **NumPy**: Для численных операций и работы с массивами.
*   **Scikit-learn**: Для разделения выборок, построения моделей, масштабирования признаков и оценки метрик.
*   **Matplotlib & Seaborn**: Для визуализации данных и результатов анализа.
*   **Scipy**: Для статистических расчетов.

## Содержание проекта

### 1. Подготовка и анализ данных (EDA)
*   Загрузка и изучение трёх датасетов.
*   Визуализация распределений признаков с помощью гистограмм и ящиков с усами.
*   Проведение корреляционного анализа для выявления взаимосвязей между признаками.
*   **Ключевой вывод EDA:** Обнаружена аномально высокая корреляция (0.98) между признаком `f2` и целевым признаком `product` в регионе `geo_data_1`, что указывает на возможную утечку данных или сильную линейную зависимость, которая значительно упрощает прогнозирование для этого региона.

### 2. Обучение модели
*   Для каждого из трёх регионов данные были разделены на обучающую (75%) и валидационную (25%) выборки.
*   В качестве основной модели была выбрана **Линейная регрессия (Linear Regression)**, как было указано в условиях задачи.
*   Для подбора оптимальных параметров предобработки использовался `RandomizedSearchCV` с кросс-валидацией для поиска наилучшей метрики RMSE.
*   Для каждого региона была обучена и оценена отдельная модель.

### 3. Расчет точки безубыточности
*   Бюджет на разработку 200 скважин в регионе — **10 млрд рублей**.
*   Доход с одного барреля сырья — **450 рублей** (450 тыс. рублей с 1 тыс. баррелей).
*   Рассчитан минимальный средний объём сырья со скважины для достижения безубыточности: **~111.1 тыс. баррелей**. Этот показатель был сопоставлен со средними запасами в каждом регионе.

### 4. Расчет прибыли и оценка рисков с помощью Bootstrap
*   Написана функция для расчёта прибыли с 200 лучших скважин, отобранных на основе предсказаний модели.
*   Для каждого региона была применена техника **Bootstrap** с 1000 выборок для построения распределения возможной прибыли.
*   На основе этого распределения были рассчитаны:
    *   Средняя прибыль.
    *   95%-й доверительный интервал.
    *   Риск убытков.

## Результаты

Финальные модели для каждого региона были оценены по ключевым бизнес-метрикам.

| Регион | Средний запас сырья (тыс. бар.) | RMSE модели | Средняя прибыль (млн руб.) | 95% Доверительный интервал (млн руб.) | Риск убытков (%) |
|---|---|---|---|---|---|
| geo_data_0 | 92.40 | 37.76 | 422.57 | от -112.5 до 969.8 | **5.2%** |
| **geo_data_1** | **68.71** | **0.89** | **448.72** | **от 44.6 до 844.7** | **1.4%** |
| geo_data_2 | 94.77 | 40.15 | 374.73 | от -153.2 до 899.1 | **9.0%** |

**Выводы из результатов:**
*   **Регион `geo_data_1`** показал аномально низкий RMSE (0.89), что подтверждает сильную предсказательную способность модели для этого набора данных.
*   Несмотря на самый низкий средний запас сырья, **регион `geo_data_1`** является единственным, который удовлетворяет требованию по риску убытков (**1.4% < 2.5%**).
*   Кроме того, этот регион демонстрирует **самую высокую среднюю прибыль** среди всех трёх.
*   Регионы `geo_data_0` и `geo_data_2` имеют слишком высокий риск убытков (5.2% и 9.0% соответственно), что делает их непригодными для разработки по заданным критериям.

**Итоговая рекомендация:** Для разработки рекомендуется **второй регион (geo_data_1)**, так как он обеспечивает наибольшую среднюю прибыль при минимальном и допустимом риске.
